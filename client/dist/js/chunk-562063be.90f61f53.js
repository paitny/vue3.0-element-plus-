(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-562063be"],{1511:function(e,t,a){"use strict";a.r(t);var r=a("7a23"),s=Object(r["hb"])("data-v-a2aa98b8");Object(r["I"])("data-v-a2aa98b8");var n={id:"User"},o=Object(r["o"])("h2",null,"修改用户名",-1),c=Object(r["o"])("h2",null,"修改密码",-1),u=Object(r["o"])("h2",null,"头像上传",-1);Object(r["G"])();var l=s((function(e,t,a,s,l,i){var b=Object(r["O"])("UpdateName"),d=Object(r["O"])("UpdatePass"),p=Object(r["O"])("UpdatePhoto");return Object(r["F"])(),Object(r["j"])("div",n,[Object(r["o"])("article",null,[o,Object(r["o"])(b)]),Object(r["o"])("article",null,[c,Object(r["o"])(d)]),Object(r["o"])("article",null,[u,Object(r["o"])(p)])])})),i=a("5530"),b=(a("ac1f"),a("5319"),Object(r["hb"])("data-v-003cc0ef"));Object(r["I"])("data-v-003cc0ef");var d={class:"UpdateName"},p={class:"code"},f=Object(r["n"])("确认修改");Object(r["G"])();var O=b((function(e,t,a,s,n,o){var c=Object(r["O"])("el-form-item"),u=Object(r["O"])("el-input"),l=Object(r["O"])("el-button"),i=Object(r["O"])("el-form");return Object(r["F"])(),Object(r["j"])("div",d,[Object(r["o"])(i,{model:n.userForm,"status-icon":"",rules:n.rules,ref:"userForm","label-width":"100px"},{default:b((function(){return[Object(r["o"])(c,{label:"当前用户名：","label-width":"100px"},{default:b((function(){return[Object(r["o"])("span",p,Object(r["S"])(e.userInfo.user),1)]})),_:1}),Object(r["o"])(c,{label:"新用户名：",prop:"user","label-width":"100px"},{default:b((function(){return[Object(r["o"])(u,{modelValue:n.userForm.user,"onUpdate:modelValue":t[1]||(t[1]=function(e){return n.userForm.user=e})},null,8,["modelValue"])]})),_:1}),Object(r["o"])(c,{"label-width":"100px"},{default:b((function(){return[Object(r["o"])(l,{type:"primary",onClick:o.submit},{default:b((function(){return[f]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model","rules"])])})),m=a("1da1"),j=(a("96cf"),a("5502")),h={name:"UpdateName",data:function(){var e=this;return{userForm:{user:""},rules:{user:[{validator:function(t,a,r){(a.length<2||a.length>8)&&r(new Error("请输入2~8位的用户名")),/^[\w\u4e00-\u9fa5\u0800-\u4e00\uac00-\ud7ff]+$/.test(a)||r(new Error("只允许 数字 字母 _ 中/日/韩文")),a===e.userInfo.user&&r(new Error("用户名没有变化...")),r()}}]}}},computed:Object(i["a"])({},Object(j["c"])(["userInfo"])),methods:Object(i["a"])(Object(i["a"])({},Object(j["b"])(["loginSuccess"])),{},{submit:function(){var e=this;this.$refs.userForm.validate(function(){var t=Object(m["a"])(regeneratorRuntime.mark((function t(a){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=12;break}return t.next=3,e.$axios({method:"POST",url:"/personal/user",data:{user:e.userForm.user}});case 3:if(r=t.sent,s=r.data,!s.code){t.next=7;break}return t.abrupt("return",e.$message.error(s.msg));case 7:e.$message.success("用户名修改成功"),e.loginSuccess(s.data),e.$refs.userForm.resetFields(),t.next=13;break;case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}})};a("2de0");h.render=O,h.__scopeId="data-v-003cc0ef";var v=h,w=Object(r["hb"])("data-v-1c99bbda");Object(r["I"])("data-v-1c99bbda");var g={id:"UpdatePass"},F=Object(r["n"])("确认修改");Object(r["G"])();var U=w((function(e,t,a,s,n,o){var c=Object(r["O"])("el-input"),u=Object(r["O"])("el-form-item"),l=Object(r["O"])("el-button"),i=Object(r["O"])("el-form");return Object(r["F"])(),Object(r["j"])("div",g,[Object(r["o"])(i,{model:n.passForm,"status-icon":"",rules:n.rules,ref:"passForm","label-width":"100px"},{default:w((function(){return[Object(r["o"])(u,{label:"原密码：",prop:"pass","label-width":"100px"},{default:w((function(){return[Object(r["o"])(c,{type:"password",modelValue:n.passForm.oldPass,"onUpdate:modelValue":t[1]||(t[1]=function(e){return n.passForm.oldPass=e})},null,8,["modelValue"])]})),_:1}),Object(r["o"])(u,{label:"新密码：",prop:"pass","label-width":"100px"},{default:w((function(){return[Object(r["o"])(c,{type:"password",modelValue:n.passForm.pass,"onUpdate:modelValue":t[2]||(t[2]=function(e){return n.passForm.pass=e})},null,8,["modelValue"])]})),_:1}),Object(r["o"])(u,{label:"确认新密码：",prop:"pass2","label-width":"100px"},{default:w((function(){return[Object(r["o"])(c,{type:"password",modelValue:n.passForm.pass2,"onUpdate:modelValue":t[3]||(t[3]=function(e){return n.passForm.pass2=e})},null,8,["modelValue"])]})),_:1}),Object(r["o"])(u,{"label-width":"100px"},{default:w((function(){return[Object(r["o"])(l,{type:"primary",onClick:o.submit},{default:w((function(){return[F]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model","rules"])])})),_={name:"UpdatePass",data:function(){var e=this;return{passForm:{oldPass:"",pass:"",pass2:""},rules:{pass:[{validator:function(e,t,a){(t.length<6||t.length>18)&&a(new Error("请输入6~18位的密码")),/^[\w\[\]\/\\~`|<>,.?;':"{}!@#$%^&*()_+=-]+$/.test(t)||a(new Error("不允许的密码字符")),a()},trigger:"input"}],pass2:[{validator:function(t,a,r){e.passForm.pass!==a&&r(new Error("两次输入密码不一致")),r()}}]}}},methods:Object(i["a"])(Object(i["a"])({},Object(j["b"])(["loginOut"])),{},{submit:function(){var e=this;this.$refs.passForm.validate(function(){var t=Object(m["a"])(regeneratorRuntime.mark((function t(a){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=13;break}return t.next=3,e.$axios({method:"POST",url:"/personal/pass",data:{oldPass:e.passForm.oldPass,pass:e.passForm.pass}});case 3:if(r=t.sent,s=r.data,!s.code){t.next=7;break}return t.abrupt("return",e.$message.error(s.msg));case 7:e.$message.success("密码修改成功，请重新登录"),e.loginOut(),e.$refs.passForm.resetFields(),e.$router.push("/"),t.next=14;break;case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}})};_.render=U,_.__scopeId="data-v-1c99bbda";var x=_,k=Object(r["hb"])("data-v-4fb9c94a");Object(r["I"])("data-v-4fb9c94a");var $={id:"UpdatePhoto"},P={key:1,class:"el-icon-plus avatar-uploader-icon"};Object(r["G"])();var I=k((function(e,t,a,s,n,o){var c=Object(r["O"])("el-alert"),u=Object(r["O"])("el-upload");return Object(r["F"])(),Object(r["j"])("div",$,[Object(r["o"])(c,{title:"上传头像",type:"warning",description:"点击下方 + 号上传并修改头像",closable:!1,"show-icon":""}),Object(r["o"])(u,{class:"avatar-uploader",action:e.baseURL+"/personal/photo","show-file-list":!1,"with-credentials":!0,"on-success":o.handleAvatarSuccess,"before-upload":o.beforeAvatarUpload},{default:k((function(){return[n.imageUrl?(Object(r["F"])(),Object(r["j"])("img",{key:0,src:n.imageUrl,class:"avatar"},null,8,["src"])):(Object(r["F"])(),Object(r["j"])("i",P))]})),_:1},8,["action","on-success","before-upload"])])})),y=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),{name:"UpdatePhoto",data:function(){return{imageUrl:""}},methods:Object(i["a"])(Object(i["a"])({},Object(j["b"])(["loginSuccess"])),{},{handleAvatarSuccess:function(e,t){if(e.code)return this.$message.error("上传失败，是稍后再试");this.imageUrl=URL.createObjectURL(t.raw),this.loginSuccess(e.data)},beforeAvatarUpload:function(e){var t=/^image\/(jpeg|png)$/.test(e.type),a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG/PNG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a}})});a("9a46");y.render=I,y.__scopeId="data-v-4fb9c94a";var V=y,S={name:"User",components:{UpdateName:v,UpdatePass:x,UpdatePhoto:V},computed:Object(i["a"])({},Object(j["c"])(["userInfo"])),watch:{userInfo:function(){this.backHome()}},methods:{backHome:function(){this.userInfo.user||(this.$message.error("当前未登录，无法修改个人信息，已自动返回首页"),this.$router.replace("/"))}},beforeRouteEnter:function(e,t,a){a((function(e){e.backHome()}))}};a("fb8a");S.render=l,S.__scopeId="data-v-a2aa98b8";t["default"]=S},"2de0":function(e,t,a){"use strict";a("ea12")},"9a46":function(e,t,a){"use strict";a("c352")},c352:function(e,t,a){},e298:function(e,t,a){},ea12:function(e,t,a){},fb8a:function(e,t,a){"use strict";a("e298")}}]);
//# sourceMappingURL=chunk-562063be.90f61f53.js.map